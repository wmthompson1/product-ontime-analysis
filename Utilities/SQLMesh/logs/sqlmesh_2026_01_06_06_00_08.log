2026-01-06 06:00:08,410 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'dev.duckdb'} (connection.py:496)
2026-01-06 06:00:08,825 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: dev.duckdb (connection.py:486)
2026-01-06 06:00:09,012 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2026-01-06 06:00:09,025 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2026-01-06 06:00:09,025 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'sqlmesh__default' (evaluator.py:1449)
2026-01-06 06:00:09,025 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__default" (base.py:2626)
2026-01-06 06:00:09,026 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2026-01-06 06:00:09,027 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:1616)
2026-01-06 06:00:09,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT CURRENT_CATALOG() (base.py:2626)
2026-01-06 06:00:09,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'dev' AND table_schema = 'sqlmesh__default') AND table_name IN ('items_model__3887795717') (base.py:2626)
2026-01-06 06:00:09,040 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"items_model": 2934511231> (evaluator.py:711)
2026-01-06 06:00:09,041 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"items_model": 2934511231> (evaluator.py:952)
2026-01-06 06:00:09,044 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2026-01-05 00:00:00, 2026-01-06 00:00:00) into sqlmesh__default.items_model__3887795717' (evaluator.py:984)
2026-01-06 06:00:09,045 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT CURRENT_CATALOG() (base.py:2626)
2026-01-06 06:00:09,046 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'dev' (base.py:2626)
2026-01-06 06:00:09,048 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ CREATE OR REPLACE TABLE "sqlmesh__default"."items_model__3887795717" AS SELECT CAST("id" AS INT) AS "id", CAST("name" AS TEXT) AS "name", CAST("qty" AS INT) AS "qty" FROM (SELECT 1 AS "id", 'test_item' AS "name", 10 AS "qty" UNION ALL SELECT 2 AS "id", 'another_item' AS "name", 20 AS "qty") AS "_subquery" (base.py:2626)
2026-01-06 06:00:09,052 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2026-01-05 00:00:00, 2026-01-06 00:00:00) for snapshot SnapshotId<"items_model": 2934511231> (facade.py:637)
2026-01-06 06:00:09,052 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"items_model": 2934511231> (interval.py:215)
2026-01-06 06:00:09,064 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2026-01-06 06:00:09,064 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2026-01-06 06:00:09,077 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2026-01-06 06:00:09,082 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2026-01-06 06:00:09,083 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'default' (evaluator.py:1449)
2026-01-06 06:00:09,083 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ CREATE SCHEMA IF NOT EXISTS "default" (base.py:2626)
2026-01-06 06:00:09,084 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema default (evaluator.py:1616)
2026-01-06 06:00:09,084 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT CURRENT_CATALOG() (base.py:2626)
2026-01-06 06:00:09,086 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'dev' AND table_schema = 'default') AND table_name IN ('items_model') (base.py:2626)
2026-01-06 06:00:09,089 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default.items_model' to point at table 'sqlmesh__default.items_model__3887795717' (evaluator.py:1988)
2026-01-06 06:00:09,090 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a0bac36ba2d148e1b863e25accaa41f7 */ CREATE OR REPLACE VIEW "default"."items_model" AS SELECT * FROM "sqlmesh__default"."items_model__3887795717" (base.py:2626)
2026-01-06 06:00:09,093 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2026-01-06 06:00:09,093 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2026-01-06 06:00:09,110 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
2026-01-06 06:00:09,115 - MainThread - sqlmesh.core.analytics.dispatcher - INFO - Failed to emit events: HTTPSConnectionPool(host='analytics.tobikodata.com', port=443): Max retries exceeded with url: /v1/sqlmesh/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f01e52c5d00>: Failed to resolve 'analytics.tobikodata.com' ([Errno -5] No address associated with hostname)")) (dispatcher.py:138)
