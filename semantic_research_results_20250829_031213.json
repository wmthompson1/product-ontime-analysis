{
  "timestamp": "2025-08-29T03:12:13.158011",
  "test_results": [
    {
      "test_id": "supply_chain_001",
      "domain": "supply_chain",
      "query": "Show suppliers with delivery performance below 95% affecting production schedule",
      "generated_sql": "```sql SELECT s.supplier_id, s.supplier_name, AVG(d.ontime_rate) AS average_ontime_rate FROM SUPPLIERS s JOIN DAILY_DELIVERIES d ON s.supplier_id = d.supplier_id GROUP BY s.supplier_id, s.supplier_name HAVING AVG(d.ontime_rate) < %s; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query joins the SUPPLIERS and DAILY_DELIVERIES tables on the supplier_id field. It then groups the results by supplier_id and supplier_name, and calculates the average ontime_rate for each supplier. The HAVING clause filters out suppliers with an average ontime_rate of 95% or higher, leaving only those with an average ontime_rate below 95%.",
      "safety_check": true,
      "quality_score": 0.4,
      "concept_coverage": 0.25,
      "contextual_hints_count": 3,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T03:11:35.031851"
    },
    {
      "test_id": "quality_001",
      "domain": "quality_control",
      "query": "Find products with NCM rates trending above industry standards",
      "generated_sql": "```sql WITH industry_standard AS ( SELECT benchmark_value FROM INDUSTRY_BENCHMARKS WHERE metric_name = 'NCM Rate' ), ncm_trend AS ( SELECT product_line, AVG(defect_rate) AS avg_defect_rate FROM PRODUCT_DEFECTS WHERE defect_type = 'NCM' GROUP BY product_line ) SELECT n.product_line, n.avg_defect_rate FROM ncm_trend n, industry_standard i WHERE n.avg_defect_rate > i.benchmark_value; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.MEDIUM",
      "explanation": " This query first creates a subquery 'industry_standard' to get the industry standard value for 'NCM Rate' from the INDUSTRY_BENCHMARKS table. Then, it creates another subquery 'ncm_trend' to calculate the average defect rate for each product line from the PRODUCT_DEFECTS table where the defect type is 'NCM'. Finally, it selects the product lines from the 'ncm_trend' subquery where the average defect rate is greater than the industry standard value. This query uses the WITH clause to create two subqueries that can be referenced multiple times in the main query. This can improve performance by reducing the amount of data that needs to be processed in the main query. The GROUP BY clause is used in the 'ncm_trend' subquery to calculate the average defect rate for each product line. The WHERE clause is used in both subqueries to filter the data based on the defect type and to compare the average defect rate with the industry standard value.",
      "safety_check": true,
      "quality_score": 0.35000000000000003,
      "concept_coverage": 1.0,
      "contextual_hints_count": 5,
      "acronyms_detected": 5,
      "timestamp": "2025-08-29T03:11:45.268458"
    },
    {
      "test_id": "production_001",
      "domain": "production_efficiency",
      "query": "Calculate OEE for critical equipment showing downtime patterns",
      "generated_sql": "``` WITH critical_equipment AS ( SELECT equipment_id, equipment_name, measurement_date, availability_rate * performance_rate * quality_rate AS oee, downtime_hours FROM equipment_metrics WHERE equipment_type = %s ), downtime_pattern AS ( SELECT equipment_id, COUNT(*) AS downtime_events, AVG(downtime_hours) AS avg_downtime_hours FROM failure_events GROUP BY equipment_id ) SELECT ce.equipment_id, ce.equipment_name, ce.measurement_date, ce.oee, ce.downtime_hours, dp.downtime_events, dp.avg_downtime_hours FROM critical_equipment ce LEFT JOIN downtime_pattern dp ON ce.equipment_id = dp.equipment_id ORDER BY ce.oee DESC; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query first creates a subquery 'critical_equipment' to calculate the OEE for each piece of critical equipment and get the downtime hours. Then it creates another subquery 'downtime_pattern' to calculate the number of downtime events and average downtime hours for each piece of equipment. Finally, it joins these two subqueries on 'equipment_id' to get the OEE and downtime patterns for each piece of critical equipment.",
      "safety_check": true,
      "quality_score": 0.5,
      "concept_coverage": 1.0,
      "contextual_hints_count": 2,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T03:11:53.546427"
    },
    {
      "test_id": "maintenance_001",
      "domain": "maintenance",
      "query": "Show equipment with MTBF below target requiring immediate attention",
      "generated_sql": "```sql SELECT em.equipment_id, em.equipment_name, er.mtbf_hours, er.target_mtbf FROM EQUIPMENT_METRICS em JOIN EQUIPMENT_RELIABILITY er ON em.equipment_id = er.equipment_id WHERE er.mtbf_hours < er.target_mtbf ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query joins the EQUIPMENT_METRICS and EQUIPMENT_RELIABILITY tables on the equipment_id field. It then selects the equipment_id, equipment_name, mtbf_hours, and target_mtbf fields where the mtbf_hours is less than the target_mtbf. This will return all equipment where the Mean Time Between Failures (MTBF) is below the target, indicating that these pieces of equipment require immediate attention.",
      "safety_check": true,
      "quality_score": 0.35000000000000003,
      "concept_coverage": 0.75,
      "contextual_hints_count": 2,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T03:12:01.105840"
    },
    {
      "test_id": "compliance_001",
      "domain": "compliance",
      "query": "Analyze CAPA effectiveness for recurring quality issues",
      "generated_sql": "```sql WITH recurring_issues AS ( SELECT ncm_id, COUNT(capa_id) AS capa_count FROM corrective_actions WHERE status = 'Completed' GROUP BY ncm_id HAVING COUNT(capa_id) > 1 ), capa_effectiveness AS ( SELECT ncm_id, AVG(effectiveness_score) AS avg_effectiveness FROM corrective_actions WHERE status = 'Completed' GROUP BY ncm_id ) SELECT ri.ncm_id, ri.capa_count, ce.avg_effectiveness FROM recurring_issues ri JOIN capa_effectiveness ce ON ri.ncm_id = ce.ncm_id ORDER BY avg_effectiveness DESC; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query first identifies recurring quality issues by counting the number of completed corrective actions (CAPAs) for each non-conformant material (NCM) incident. It then calculates the average effectiveness score for each NCM incident. The final result is a list of recurring NCM incidents, along with the number of CAPAs and the average effectiveness score for each. The results are ordered by the average effectiveness score in descending order, so the most effectively resolved recurring issues are listed first.",
      "safety_check": true,
      "quality_score": 0.6000000000000001,
      "concept_coverage": 0.75,
      "contextual_hints_count": 4,
      "acronyms_detected": 3,
      "timestamp": "2025-08-29T03:12:13.157864"
    }
  ],
  "summary_statistics": {
    "total_tests": 5,
    "successful_tests": 5,
    "success_rate": 1.0,
    "average_quality": 0.44000000000000006,
    "average_confidence": 1.0,
    "average_concept_coverage": 0.75,
    "total_acronyms_detected": 14,
    "safety_compliance": 1.0
  },
  "domain_analysis": {
    "supply_chain": {
      "count": 1,
      "quality_scores": [
        0.4
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        0.25
      ],
      "avg_quality": 0.4,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 0.25
    },
    "quality_control": {
      "count": 1,
      "quality_scores": [
        0.35000000000000003
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        1.0
      ],
      "avg_quality": 0.35000000000000003,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 1.0
    },
    "production_efficiency": {
      "count": 1,
      "quality_scores": [
        0.5
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        1.0
      ],
      "avg_quality": 0.5,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 1.0
    },
    "maintenance": {
      "count": 1,
      "quality_scores": [
        0.35000000000000003
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        0.75
      ],
      "avg_quality": 0.35000000000000003,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 0.75
    },
    "compliance": {
      "count": 1,
      "quality_scores": [
        0.6000000000000001
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        0.75
      ],
      "avg_quality": 0.6000000000000001,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 0.75
    }
  },
  "research_insights": [
    "High success rate indicates robust SQL generation capabilities",
    "SQL quality could be improved through better domain knowledge integration",
    "Strong business concept coverage in generated queries",
    "Strongest performance in compliance domain (quality: 0.60)",
    "Contextual hints successfully detected 14 manufacturing acronyms"
  ]
}