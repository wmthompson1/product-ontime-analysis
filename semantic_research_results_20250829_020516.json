{
  "timestamp": "2025-08-29T02:05:16.280199",
  "test_results": [
    {
      "test_id": "supply_chain_001",
      "domain": "supply_chain",
      "query": "Show suppliers with delivery performance below 95% affecting production schedule",
      "generated_sql": "```sql SELECT s.supplier_id, s.supplier_name, AVG(d.ontime_rate) AS average_ontime_rate FROM SUPPLIERS s JOIN DAILY_DELIVERIES d ON s.supplier_id = d.supplier_id GROUP BY s.supplier_id, s.supplier_name HAVING AVG(d.ontime_rate) < %s; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query joins the SUPPLIERS and DAILY_DELIVERIES tables on the supplier_id field. It then groups the results by supplier_id and supplier_name, and calculates the average ontime_rate for each supplier. The HAVING clause filters out suppliers with an average ontime_rate of 95% or higher, leaving only those suppliers with an average ontime_rate below 95%.",
      "safety_check": true,
      "quality_score": 0.4,
      "concept_coverage": 0.25,
      "contextual_hints_count": 3,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T02:04:33.798357"
    },
    {
      "test_id": "quality_001",
      "domain": "quality_control",
      "query": "Find products with NCM rates trending above industry standards",
      "generated_sql": "```sql WITH industry_standard AS ( SELECT benchmark_value FROM INDUSTRY_BENCHMARKS WHERE metric_name = 'NCM Rate' ), ncm_trend AS ( SELECT product_line, AVG(defect_rate) AS avg_defect_rate FROM PRODUCT_DEFECTS WHERE defect_type = 'NCM' GROUP BY product_line ) SELECT n.product_line, n.avg_defect_rate FROM ncm_trend n, industry_standard i WHERE n.avg_defect_rate > i.benchmark_value; ```",
      "confidence": 0.9,
      "complexity": "QueryComplexity.MEDIUM",
      "explanation": " This query first creates a subquery (industry_standard) to get the industry standard for NCM Rate from the INDUSTRY_BENCHMARKS table. Then, it creates another subquery (ncm_trend) to calculate the average defect rate for each product line from the PRODUCT_DEFECTS table where the defect type is 'NCM'. Finally, it selects the product lines from the ncm_trend subquery where the average defect rate is greater than the industry standard. This query uses the WITH clause to create two subqueries that can be referenced in the final SELECT statement. This approach simplifies the final SELECT statement and improves readability. The performance of this query depends on the number of records in the PRODUCT_DEFECTS and INDUSTRY_BENCHMARKS tables. If these tables have a large number of records, it may be beneficial to create indexes on the defect_type column of the PRODUCT_DEFECTS table and the metric_name column of the INDUSTRY_BENCHMARKS table to speed up the query.",
      "safety_check": true,
      "quality_score": 0.35000000000000003,
      "concept_coverage": 1.0,
      "contextual_hints_count": 5,
      "acronyms_detected": 5,
      "timestamp": "2025-08-29T02:04:50.485906"
    },
    {
      "test_id": "production_001",
      "domain": "production_efficiency",
      "query": "Calculate OEE for critical equipment showing downtime patterns",
      "generated_sql": "```sql WITH critical_equipment AS ( SELECT equipment_id, equipment_name, measurement_date, availability_rate * performance_rate * quality_rate AS oee, downtime_hours FROM equipment_metrics WHERE equipment_type = %s ), downtime_pattern AS ( SELECT equipment_id, equipment_name, measurement_date, oee, downtime_hours, LAG(downtime_hours) OVER (PARTITION BY equipment_id ORDER BY measurement_date) AS previous_downtime, downtime_hours - LAG(downtime_hours) OVER (PARTITION BY equipment_id ORDER BY measurement_date) AS downtime_difference FROM critical_equipment ) SELECT equipment_id, equipment_name, measurement_date, oee, downtime_hours, previous_downtime, downtime_difference FROM downtime_pattern ORDER BY equipment_id, measurement_date; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query first creates a temporary table 'critical_equipment' that selects all the critical equipment from the 'equipment_metrics' table and calculates their OEE. Then, it creates another temporary table 'downtime_pattern' that calculates the difference in downtime hours between the current and previous measurement dates for each equipment. Finally, it selects all the columns from the 'downtime_pattern' table and orders the result by equipment_id and measurement_date.",
      "safety_check": true,
      "quality_score": 0.30000000000000004,
      "concept_coverage": 1.0,
      "contextual_hints_count": 2,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T02:05:04.649862"
    },
    {
      "test_id": "maintenance_001",
      "domain": "maintenance",
      "query": "Show equipment with MTBF below target requiring immediate attention",
      "generated_sql": "```sql SELECT em.equipment_name, er.mtbf_hours, er.target_mtbf FROM equipment_reliability er JOIN equipment_metrics em ON er.equipment_id = em.equipment_id WHERE er.mtbf_hours < er.target_mtbf; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query joins the 'equipment_reliability' table with the 'equipment_metrics' table on the 'equipment_id' field. It then selects the 'equipment_name', 'mtbf_hours', and 'target_mtbf' fields where the 'mtbf_hours' is less than the 'target_mtbf'. This will return a list of equipment where the Mean Time Between Failures (MTBF) is below the target, indicating that these pieces of equipment require immediate attention.",
      "safety_check": true,
      "quality_score": 0.35000000000000003,
      "concept_coverage": 0.75,
      "contextual_hints_count": 2,
      "acronyms_detected": 2,
      "timestamp": "2025-08-29T02:05:10.323391"
    },
    {
      "test_id": "compliance_001",
      "domain": "compliance",
      "query": "Analyze CAPA effectiveness for recurring quality issues",
      "generated_sql": "```sql WITH recurring_issues AS ( SELECT ncm_id, COUNT(*) AS recurrence_count FROM non_conformant_materials GROUP BY ncm_id HAVING COUNT(*) > 1 ), capa_effectiveness AS ( SELECT capa_id, ncm_id, effectiveness_score FROM corrective_actions WHERE ncm_id IN (SELECT ncm_id FROM recurring_issues) ) SELECT ncm_id, AVG(effectiveness_score) AS average_effectiveness FROM capa_effectiveness GROUP BY ncm_id ORDER BY average_effectiveness DESC; ```",
      "confidence": 1.0,
      "complexity": "QueryComplexity.SIMPLE",
      "explanation": " This query first identifies recurring quality issues by counting the number of times each NCM incident occurs in the non_conformant_materials table. It then selects the effectiveness scores of the corrective actions associated with these recurring issues. Finally, it calculates the average effectiveness score for each recurring issue and orders the results by this average score in descending order.",
      "safety_check": true,
      "quality_score": 0.5,
      "concept_coverage": 1.0,
      "contextual_hints_count": 4,
      "acronyms_detected": 3,
      "timestamp": "2025-08-29T02:05:16.280002"
    }
  ],
  "summary_statistics": {
    "total_tests": 5,
    "successful_tests": 5,
    "success_rate": 1.0,
    "average_quality": 0.38,
    "average_confidence": 0.9800000000000001,
    "average_concept_coverage": 0.8,
    "total_acronyms_detected": 14,
    "safety_compliance": 1.0
  },
  "domain_analysis": {
    "supply_chain": {
      "count": 1,
      "quality_scores": [
        0.4
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        0.25
      ],
      "avg_quality": 0.4,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 0.25
    },
    "quality_control": {
      "count": 1,
      "quality_scores": [
        0.35000000000000003
      ],
      "confidence_scores": [
        0.9
      ],
      "concept_coverage": [
        1.0
      ],
      "avg_quality": 0.35000000000000003,
      "avg_confidence": 0.9,
      "avg_concept_coverage": 1.0
    },
    "production_efficiency": {
      "count": 1,
      "quality_scores": [
        0.30000000000000004
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        1.0
      ],
      "avg_quality": 0.30000000000000004,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 1.0
    },
    "maintenance": {
      "count": 1,
      "quality_scores": [
        0.35000000000000003
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        0.75
      ],
      "avg_quality": 0.35000000000000003,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 0.75
    },
    "compliance": {
      "count": 1,
      "quality_scores": [
        0.5
      ],
      "confidence_scores": [
        1.0
      ],
      "concept_coverage": [
        1.0
      ],
      "avg_quality": 0.5,
      "avg_confidence": 1.0,
      "avg_concept_coverage": 1.0
    }
  },
  "research_insights": [
    "High success rate indicates robust SQL generation capabilities",
    "SQL quality could be improved through better domain knowledge integration",
    "Strong business concept coverage in generated queries",
    "Strongest performance in compliance domain (quality: 0.50)",
    "Contextual hints successfully detected 14 manufacturing acronyms"
  ]
}